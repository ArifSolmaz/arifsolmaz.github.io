<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dr. Arif Solmaz | Astrophysicist & Educator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Dr. Arif Solmaz ‚Äî astrophysicist working on exoplanets, stellar activity, and scientific computing." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #020617;
      --accent: #f97316; /* Star Orange */
      --accent2: #38bdf8; /* Data Blue */
      --text: #e2e8f0;
      --muted: #94a3b8;
      --border: rgba(148, 163, 184, 0.15);
      --card-bg: rgba(15, 23, 42, 0.6);
      --radius: 1rem;
      --max-width: 1100px;
    }

    /* BASE RESET */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; scroll-padding-top: 80px; } 
    
    body {
      font-family: "Inter", sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
    }

    a { text-decoration: none; color: inherit; transition: 0.2s; }
    ul { list-style: none; }

    /* BACKGROUND FX */
    #star-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
    .noise {
      position: fixed; inset: 0; z-index: 50; pointer-events: none; opacity: 0.04;
      background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.6' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    }

    /* LAYOUT */
    .shell { max-width: var(--max-width); margin: 0 auto; padding: 0 1.5rem; }
    section { padding: 5rem 0; border-bottom: 1px solid var(--border); }
    section:last-child { border-bottom: none; }

    /* HEADER */
    header {
      position: sticky; top: 0; z-index: 40;
      backdrop-filter: blur(12px);
      background: rgba(2, 6, 23, 0.85);
      border-bottom: 1px solid var(--border);
    }
    .nav {
      height: 70px; display: flex; align-items: center; justify-content: space-between;
    }
    .brand { font-family: "Space Grotesk", sans-serif; font-weight: 700; font-size: 1.1rem; letter-spacing: -0.02em; }
    .brand span { color: var(--accent); }
    
    .nav-links { display: flex; gap: 2rem; font-size: 0.9rem; font-weight: 500; }
    .nav-links a:hover { color: var(--accent2); }
    @media(max-width: 768px) { .nav-links { display: none; } }

    /* HERO */
    .hero { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 3rem; align-items: center; min-height: 80vh; padding-top: 2rem; }
    @media(max-width: 900px) { .hero { grid-template-columns: 1fr; text-align: center; } }

    .hero-kicker {
      font-family: "JetBrains Mono", monospace; font-size: 0.8rem; color: var(--accent2);
      margin-bottom: 1rem; display: inline-block; padding: 0.2rem 0.8rem; 
      border: 1px solid rgba(56, 189, 248, 0.2); border-radius: 100px;
    }

    .hero h1 {
      font-family: "Space Grotesk", sans-serif; font-size: clamp(2.5rem, 5vw, 3.5rem);
      line-height: 1.1; font-weight: 700; margin-bottom: 1.5rem;
      background: linear-gradient(to bottom right, #fff 30%, #64748b 100%);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }

    .hero p { font-size: 1.1rem; color: var(--muted); margin-bottom: 2rem; max-width: 540px; }
    @media(max-width: 900px) { .hero p { margin-left: auto; margin-right: auto; } }

    .btn {
      display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.8rem 1.5rem;
      border-radius: 8px; font-weight: 600; font-size: 0.95rem; cursor: pointer;
    }
    .btn-primary { background: var(--text); color: var(--bg); border: 1px solid var(--text); }
    .btn-primary:hover { background: var(--accent2); border-color: var(--accent2); box-shadow: 0 0 20px rgba(56, 189, 248, 0.3); }
    
    /* === INTERACTIVE WASP-52b SIMULATION === */
    .transit-viz {
      position: relative; width: 100%; height: 420px;
      background: linear-gradient(180deg, #0f172a, #020617);
      border: 1px solid var(--border); border-radius: 1.5rem;
      display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
      overflow: hidden; padding-top: 20px;
      box-shadow: inset 0 0 60px rgba(0,0,0,0.6);
      user-select: none; /* Vital for dragging */
      touch-action: none; /* Vital for mobile drag */
    }

    .live-readout {
      position: absolute; top: 15px; right: 20px;
      font-family: "JetBrains Mono", monospace; font-size: 0.75rem; color: var(--accent);
      background: rgba(249, 115, 22, 0.1); padding: 6px 10px; border-radius: 6px;
      border: 1px solid rgba(249, 115, 22, 0.2);
      z-index: 30;
    }

    /* Simulation Stage (Star + Planet) */
    .sim-stage {
      position: relative;
      width: 100%; height: 200px;
      cursor: default;
    }

    /* WASP-52 (K2V Star) - More Orange/Reddish */
    .star-sim {
      width: 140px; height: 140px; border-radius: 50%;
      /* K-type star gradient: Brighter center, darker orange/red limb */
      background: radial-gradient(circle at 40% 40%, #fff7ed 5%, #fb923c 45%, #c2410c 85%, #7c2d12 100%);
      box-shadow: 0 0 60px rgba(234, 88, 12, 0.3);
      position: absolute; 
      top: 50%; left: 50%; transform: translate(-50%, -50%);
      z-index: 1;
    }
    
    /* Starspot */
    .star-spot {
      position: absolute; width: 18px; height: 12px; 
      background: rgba(60, 10, 0, 0.85);
      border-radius: 50%; 
      top: 50%; left: 50%; 
      transform: translate(-50%, -50%) rotate(-15deg);
      filter: blur(1px);
      box-shadow: inset 0 0 4px rgba(0,0,0,0.9);
    }

    /* WASP-52 b (Inflated Hot Jupiter) */
    .planet-sim {
      width: 26px; height: 26px; background: #050505; border-radius: 50%;
      position: absolute; 
      top: 50%; left: 15%; /* Start pos */
      transform: translate(-50%, -50%);
      z-index: 10;
      box-shadow: inset 3px 3px 6px rgba(255,255,255,0.15);
      cursor: grab;
      transition: transform 0.1s;
    }
    .planet-sim:active { cursor: grabbing; transform: translate(-50%, -50%) scale(1.1); }

    /* The Graph Area */
    .graph-container {
      position: relative;
      width: 85%; height: 140px;
      margin-top: 10px;
      border-left: 2px solid #475569;
      border-bottom: 2px solid #475569;
      /* Scientific Grid */
      background-image: 
        linear-gradient(rgba(255,255,255,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px);
      background-size: 40px 40px;
    }

    .graph-labels {
      position: absolute; width: 100%; height: 100%; pointer-events: none;
    }
    .label-y {
      position: absolute; left: -30px; top: 50%;
      transform: rotate(-90deg) translateX(50%); transform-origin: left;
      font-family: "JetBrains Mono"; font-size: 0.7rem; color: var(--muted); letter-spacing: 1px;
    }
    .label-x {
      position: absolute; bottom: -25px; right: 0;
      font-family: "JetBrains Mono"; font-size: 0.7rem; color: var(--muted); letter-spacing: 1px;
    }

    /* SVG Graph */
    .curve-svg { width: 100%; height: 100%; overflow: visible; }
    
    .curve-path {
      fill: none; stroke: var(--accent2); stroke-width: 3; 
      stroke-linecap: round; stroke-linejoin: round;
      vector-effect: non-scaling-stroke;
      filter: drop-shadow(0 0 4px rgba(56,189,248,0.3));
    }
    
    /* The Tracking Dot */
    .graph-dot {
      width: 12px; height: 12px; background: #fff; border-radius: 50%;
      position: absolute; 
      top: 0; left: 0; 
      transform: translate(-50%, -50%);
      box-shadow: 0 0 15px var(--accent2);
      z-index: 20;
      pointer-events: none; /* Let clicks pass through */
    }

    /* SECTIONS & CARDS */
    .section-head { margin-bottom: 2.5rem; }
    .section-head h2 { font-family: "Space Grotesk", sans-serif; font-size: 2rem; margin-bottom: 0.5rem; }
    .section-head p { color: var(--muted); max-width: 600px; }

    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
    
    .card {
      background: var(--card-bg); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 2rem;
      position: relative; overflow: hidden; transition: transform 0.2s;
      display: flex; flex-direction: column;
    }
    .card:hover { transform: translateY(-4px); border-color: rgba(255,255,255,0.1); }
    
    .card::before {
      content: ""; position: absolute; inset: 0;
      background: radial-gradient(800px circle at var(--x) var(--y), rgba(255,255,255,0.06), transparent 40%);
      opacity: 0; transition: opacity 0.3s; pointer-events: none;
    }
    .grid:hover .card::before { opacity: 1; }

    .card h3 { font-family: "Space Grotesk"; font-size: 1.25rem; margin-bottom: 0.8rem; color: #fff; }
    .card p { color: var(--muted); font-size: 0.95rem; margin-bottom: 1.5rem; flex-grow: 1; }
    
    .tags { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .tag {
      font-size: 0.75rem; font-family: "JetBrains Mono"; color: var(--accent2);
      background: rgba(56, 189, 248, 0.1); padding: 0.2rem 0.6rem; border-radius: 4px;
    }

    /* ADS PUB CARD */
    .pub-card {
      grid-column: 1 / -1;
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.8), rgba(2, 6, 23, 0.9));
      border: 1px solid var(--border);
    }
    .pub-list { 
      display: flex; 
      flex-direction: column; 
      gap: 1.2rem; 
      min-height: 120px; /* Give it some space while loading */
      justify-content: center;
      align-items: center;
      text-align: center;
      color: var(--muted);
      font-size: 0.9rem;
    }
    .pub-item {
      display: grid; grid-template-columns: 60px 1fr; gap: 1.2rem;
      padding-bottom: 1.2rem; border-bottom: 1px solid var(--border);
    }
    .pub-item:last-child { border-bottom: none; padding-bottom: 0; }
    
    .pub-year {
      font-family: "JetBrains Mono"; color: var(--accent); font-weight: bold;
      font-size: 0.9rem; text-align: right; padding-top: 0.2rem;
    }
    .pub-title {
      font-weight: 600; color: var(--text); margin-bottom: 0.3rem; display: block;
      transition: color 0.2s;
    }
    .pub-title:hover { color: var(--accent2); text-decoration: underline; text-decoration-color: var(--accent2); }
    .pub-meta { font-size: 0.85rem; color: var(--muted); line-height: 1.5; }
    
    .ads-link-btn {
      margin-top: 1.5rem;
      display: inline-flex; align-items: center; gap: 0.6rem;
      font-size: 0.85rem; color: var(--accent2); font-weight: 500;
      font-family: "JetBrains Mono";
    }
    .ads-link-btn:hover { color: #fff; }

    /* CODE & CONTACT */
    .repo-item {
      display: flex; justify-content: space-between; align-items: baseline;
      padding: 1rem 0; border-bottom: 1px solid var(--border);
    }
    .repo-name { font-family: "JetBrains Mono"; font-weight: 700; color: var(--text); }
    .repo-desc { font-size: 0.9rem; color: var(--muted); margin-top: 0.2rem; }
    .repo-stat { font-size: 0.8rem; color: var(--muted); display: flex; gap: 1rem; }

    .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
    @media(max-width: 700px) { .contact-grid { grid-template-columns: 1fr; } }
    .contact-list li { margin-bottom: 1rem; display: flex; align-items: center; gap: 0.8rem; }
    .icon { width: 24px; text-align: center; font-size: 1.2rem; }

    footer { padding: 3rem 0; text-align: center; font-size: 0.85rem; color: var(--muted); border-top: 1px solid var(--border); }
  </style>
</head>
<body>

<canvas id="star-canvas"></canvas>
<div class="noise"></div>

<header>
  <div class="shell nav">
    <a href="#" class="brand">Dr. Arif <span>Solmaz</span></a>
    <div class="nav-links">
      <a href="#research">Research</a>
      <a href="#teaching">Teaching</a>
      <a href="#code">Code</a>
      <a href="#contact">Contact</a>
    </div>
  </div>
</header>

<main class="shell">

  <section class="hero">
    <div>
      <span class="hero-kicker">Astrophysics ¬∑ Data Science</span>
      <h1>Decoding signals from <br>noisy stars.</h1>
      <p>
        I study transiting exoplanets like <strong>WASP-52 b</strong>, stellar activity, and time-series analysis. 
        I build models to understand what happens when real data meets simple physics.
      </p>
      <a href="#research" class="btn btn-primary">Explore Research ‚Üì</a>
    </div>

    <div class="transit-viz">
      <div class="live-readout">target: WASP-52 b</div>

      <div class="sim-stage" id="sim-stage">
        <div class="star-sim">
          <div class="star-spot"></div>
        </div>
        <div class="planet-sim" id="planet"></div>
      </div>
      
      <div class="graph-container">
        <div class="graph-labels">
          <span class="label-y">Relative Flux</span>
          <span class="label-x">Time</span>
        </div>

        <svg class="curve-svg" preserveAspectRatio="none" viewBox="0 0 400 100">
           <path id="curve-path" class="curve-path" d="" />
        </svg>
        
        <div class="graph-dot" id="graph-dot"></div>
      </div>
    </div>
  </section>

  <section id="research">
    <div class="section-head">
      <h2>Research Focus</h2>
      <p>My work focuses on the intersection of stellar activity and exoplanet characterization. I ask: "How does the star affect what we know about the planet?"</p>
    </div>

    <div class="grid" id="research-grid">
      <div class="card">
        <h3>Exoplanets & Activity</h3>
        <p>
          Many interesting planets orbit active stars. Starspots and faculae distort transit light curves, affecting radius and timing measurements. I model these distortions to recover accurate planetary parameters.
        </p>
        <div class="tags">
          <span class="tag">TESS/Kepler</span>
          <span class="tag">Transit Modeling</span>
        </div>
      </div>

      <div class="card">
        <h3>Stellar Physics</h3>
        <p>
          Treating stellar noise as a signal. By analyzing the variability in light curves, we can map surface features (spots) and understand the magnetic evolution of host stars.
        </p>
        <div class="tags">
          <span class="tag">Starspots</span>
          <span class="tag">Differential Rotation</span>
        </div>
      </div>

      <div class="card">
        <h3>Methods</h3>
        <p>
          I prefer pragmatic modeling: models that are just complex enough to answer the question. I use Bayesian inference and MCMC to quantify uncertainties honestly.
        </p>
        <div class="tags">
          <span class="tag">Bayesian Inference</span>
          <span class="tag">Python</span>
        </div>
      </div>

      <div class="card pub-card">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem;">
          <h3 style="margin:0; font-size:1.1rem; display:flex; align-items:center; gap:0.5rem;">
            Selected Publication <span style="font-size:0.8rem; opacity:0.6; font-weight:400;">(via NASA ADS)</span>
          </h3>
        </div>
        
        <div class="pub-list" id="random-publication-container">
          <p>Loading a random publication...</p>
        </div>

        <a href="https://ui.adsabs.harvard.edu/search/fq=%7B!type%3Daqp%20v%3D%24fq_database%7D&fq_database=(database%3Aastronomy%20OR%20database%3Aphysics)&q=author%3A%22Solmaz%2C%20Arif%22&sort=date%20desc%2C%20bibcode%20desc&p_=0" target="_blank" class="ads-link-btn">
          View full library on NASA ADS <span style="font-size:1.2rem;">‚Üí</span>
        </a>
      </div>
    </div>
  </section>

  <section id="teaching">
    <div class="section-head">
      <h2>Teaching & Mentoring</h2>
      <p>Courses, labs, and student projects designed to build "Data Literacy."</p>
    </div>

    <div class="grid">
      <div class="card">
        <h3>For Students</h3>
        <p>
          I teach physics and programming (Python/C) often for engineering students. 
          My goal is to move students from "following the recipe" to "understanding the ingredients."
          We use real satellite data, not just textbook examples.
        </p>
      </div>
      <div class="card">
        <h3>Project Philosophy</h3>
        <p>
          Good research projects are focused and finite. I value readable code, 
          clear visualizations, and honest error bars over complex "black box" solutions.
        </p>
        <div class="tags">
          <span class="tag">Open Science</span>
          <span class="tag">Reproducibility</span>
        </div>
      </div>
    </div>
  </section>

  <section id="code">
    <div class="section-head">
      <h2>Code & Software</h2>
      <p>Open source tools and workflows for astrophysical time-series analysis.</p>
    </div>

    <div class="card" style="padding: 0 2rem;">
      <div class="repo-item">
        <div>
          <div class="repo-name">transit-analysis-workflow</div>
          <div class="repo-desc">A robust pipeline for analyzing TESS light curves using `lightkurve` and `batman`.</div>
        </div>
        <div class="repo-stat">Python</div>
      </div>

      <div class="repo-item">
        <div>
          <div class="repo-name">starspot-modelling</div>
          <div class="repo-desc">Scripts for simulating the effect of starspot crossings on transit depth.</div>
        </div>
        <div class="repo-stat">Jupyter</div>
      </div>

      <div class="repo-item" style="border: none;">
        <div>
          <div class="repo-name">teaching-materials</div>
          <div class="repo-desc">Public Labs and Colab notebooks for Physics and Data Analysis courses.</div>
        </div>
        <div class="repo-stat">Markdown</div>
      </div>
    </div>
    <div style="margin-top: 1.5rem;">
      <a href="https://github.com/arifsolmaz" target="_blank" style="font-size: 0.9rem; color: var(--accent2);">
        View all repositories on GitHub ‚Üí
      </a>
    </div>
  </section>

  <section id="contact">
    <div class="section-head">
      <h2>Get In Touch</h2>
      <p>I welcome emails from students and collaborators interested in exoplanets.</p>
    </div>

    <div class="contact-grid">
      <div class="card">
        <h3>Before you write</h3>
        <p>
          To make our conversation efficient, please include:
        </p>
        <ul style="font-size: 0.9rem; color: var(--muted); list-style: disc; margin-left: 1.2rem; margin-bottom: 1rem;">
          <li>Your background (student, researcher, etc.)</li>
          <li>Specific topic (e.g., "WASP-52b data analysis")</li>
          <li>Rough timeline or scope of the question</li>
        </ul>
        <p>Short, concrete emails are the best.</p>
      </div>

      <div class="card" style="justify-content: center;">
        <ul class="contact-list">
          <li>
            <span class="icon">‚úâÔ∏è</span>
            <a href="mailto:arif.solmaz@gmail.com">arif.solmaz@gmail.com</a>
          </li>
          <li>
            <span class="icon">üêô</span>
            <a href="https://github.com/arifsolmaz" target="_blank">github.com/arifsolmaz</a>
          </li>
          <li>
            <span class="icon">üéì</span>
            <a href="https://scholar.google.com/citations?user=KukbrjkAAAAJ" target="_blank">Google Scholar</a>
          </li>
          <li>
            <span class="icon">üÜî</span>
            <a href="https://orcid.org/0000-0002-3076-164X" target="_blank">ORCID Profile</a>
          </li>
        </ul>
      </div>
    </div>
  </section>

</main>

<footer>
  <div class="shell">
    ¬© <span id="year"></span> Dr. Arif Solmaz. <br>
    Built with pure HTML/CSS & JS.
  </div>
</footer>

<script>
  /* --- 1. DYNAMIC YEAR --- */
  document.getElementById("year").textContent = new Date().getFullYear();

  /* --- 2. SPOTLIGHT EFFECT --- */
  const grids = document.querySelectorAll('.grid');
  grids.forEach(grid => {
    grid.addEventListener('mousemove', e => {
      const cards = grid.querySelectorAll('.card');
      for(const card of cards) {
        const rect = card.getBoundingClientRect(),
              x = e.clientX - rect.left,
              y = e.clientY - rect.top;
        card.style.setProperty('--x', `${x}px`);
        card.style.setProperty('--y', `${y}px`);
      }
    });
  });

  /* --- 3. STARFIELD BACKGROUND --- */
  const canvas = document.getElementById('star-canvas');
  const ctx = canvas.getContext('2d');
  let w, h, stars = [];
  const initStars = () => {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
    stars = Array.from({length: 100}, () => ({
      x: Math.random() * w, y: Math.random() * h,
      r: Math.random() * 1.5, a: Math.random(), s: Math.random() * 0.05
    }));
  };
  const animateStars = () => {
    ctx.clearRect(0, 0, w, h); ctx.fillStyle = "white";
    stars.forEach(t => {
      ctx.globalAlpha = t.a; ctx.beginPath(); ctx.arc(t.x, t.y, t.r, 0, 6.28); ctx.fill();
      t.y -= t.s; if(t.y < 0) t.y = h;
    });
    requestAnimationFrame(animateStars);
  };
  window.addEventListener('resize', initStars);
  initStars(); animateStars();

  /* --- 4. INTERACTIVE PHYSICS ENGINE (WASP-52b) --- */
  const simStage = document.getElementById('sim-stage');
  const planet = document.getElementById('planet');
  const curvePath = document.getElementById('curve-path');
  const graphDot = document.getElementById('graph-dot');

  let isDragging = false;
  const STAR_RADIUS = 70; 
  const PLANET_RADIUS = 13; 
  const SPOT_RADIUS = 9;
  
  // Current state (percentages)
  let planetX = 15; 
  let planetY = 50;

  const mapRange = (val, inMin, inMax, outMin, outMax) => 
    (val - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;
  const smoothEase = (t) => (1 - Math.cos(t * Math.PI)) / 2;

  function startDrag(e) {
    isDragging = true;
    simStage.style.cursor = 'grabbing';
    planet.style.cursor = 'grabbing';
    handleMove(e);
  }
  function stopDrag() {
    isDragging = false;
    simStage.style.cursor = 'default';
    planet.style.cursor = 'grab';
  }
  function handleMove(e) {
    if (!isDragging) return;
    e.preventDefault(); 
    const rect = simStage.getBoundingClientRect();
    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
    let x = Math.max(0, Math.min(clientX - rect.left, rect.width));
    let y = Math.max(0, Math.min(clientY - rect.top, rect.height));
    planetX = (x / rect.width) * 100;
    planetY = (y / rect.height) * 100;
    updateVisuals();
    calculateLightCurve();
  }
  function updateVisuals() {
    planet.style.left = `${planetX}%`;
    planet.style.top = `${planetY}%`;
  }
  function getFlux(x, y) {
    let flux = 1.0;
    const dist = Math.sqrt(x*x + y*y);
    if (dist < STAR_RADIUS + PLANET_RADIUS) {
      let overlap = 0;
      if (dist <= STAR_RADIUS - PLANET_RADIUS) { overlap = 1.0; } 
      else {
        let edgeFactor = (STAR_RADIUS + PLANET_RADIUS - dist) / (2 * PLANET_RADIUS);
        overlap = smoothEase(Math.max(0, Math.min(1, edgeFactor)));
      }
      let mu = (dist < STAR_RADIUS) ? Math.sqrt(1 - (dist/STAR_RADIUS)**2) : 0;
      const intensity = 1.0 - 0.5 * (1 - mu); 
      flux -= 0.026 * overlap * intensity;
    }
    const distSpot = Math.sqrt(x*x + y*y);
    const interactRad = PLANET_RADIUS + SPOT_RADIUS;
    if (distSpot < interactRad) {
      const sigma = interactRad / 2.2; 
      const gaussian = Math.exp(-0.5 * (distSpot * distSpot) / (sigma * sigma));
      if (flux < 1.0) flux += 0.008 * gaussian;
    }
    return flux;
  }
  function calculateLightCurve() {
    const w = simStage.offsetWidth;
    const h = simStage.offsetHeight;
    const cx = w / 2;
    const cy = h / 2;
    const dx = (planetX / 100 * w) - cx;
    const dy = (planetY / 100 * h) - cy;
    const points = [];
    const scanWidth = 400; 
    for (let i = 0; i <= scanWidth; i+=5) {
      const physX = mapRange(i, 0, scanWidth, -180, 180);
      const f = getFlux(physX, dy); 
      const plotY = mapRange(f, 1.0, 0.974, 20, 90);
      points.push(`${i},${plotY.toFixed(1)}`);
    }
    curvePath.setAttribute('d', `M${points.join(' L')}`);
    const fNow = getFlux(dx, dy);
    const dotX = mapRange(dx, -180, 180, 0, 100); 
    const dotY = mapRange(fNow, 1.0, 0.974, 20, 90); 
    if (dotX >= 0 && dotX <= 100) {
      graphDot.style.opacity = 1;
      graphDot.style.left = `${dotX}%`;
      graphDot.style.top = `${mapRange(dotY, 0, 100, 0, 100)}%`;
    } else { graphDot.style.opacity = 0.3; }
  }
  simStage.addEventListener('mousedown', startDrag);
  window.addEventListener('mousemove', handleMove);
  window.addEventListener('mouseup', stopDrag);
  simStage.addEventListener('touchstart', startDrag, {passive: false});
  window.addEventListener('touchmove', handleMove, {passive: false});
  window.addEventListener('touchend', stopDrag);
  updateVisuals(); calculateLightCurve();

  /* --- 5. STATIC PUBLICATION LOADER (From publications.json) --- */
  async function fetchAndDisplayRandomPublication() {
    const container = document.getElementById('random-publication-container');
    container.innerHTML = '<p>Loading a random publication...</p>'; 

    try {
      // Fetch the LOCAL file you uploaded
      const response = await fetch('publications.json'); 

      if (!response.ok) {
        throw new Error(`Could not load publications.json. Make sure you uploaded the file!`);
      }

      const data = await response.json();
      const docs = data.response.docs;

      if (docs && docs.length > 0) {
        const randomIndex = Math.floor(Math.random() * docs.length);
        const pub = docs[randomIndex];

        let journalInfo = pub.bibstem || (pub.journal ? pub.journal[0] : '');
        if (pub.volume) journalInfo += ` Vol.${pub.volume}`;
        if (pub.page) journalInfo += ` p.${pub.page}`;

        let doiLink = '#';
        if (pub.doi && pub.doi.length > 0) {
            doiLink = `https://doi.org/${pub.doi[0]}`;
        } else if (pub.bibcode) {
            doiLink = `https://ui.adsabs.harvard.edu/abs/${pub.bibcode}/abstract`;
        }

        container.innerHTML = `
          <div class="pub-item">
            <div class="pub-year">${pub.year}</div>
            <div>
              <a href="${doiLink}" target="_blank" class="pub-title">
                ${pub.title ? pub.title[0] : 'No Title Available'}
              </a>
              <div class="pub-meta">
                <span style="color:var(--accent2);">${journalInfo || 'Journal info unavailable'}.</span> 
                ${pub.abstract ? pub.abstract : 'Abstract unavailable.'}
              </div>
            </div>
          </div>
        `;
      } else {
        container.innerHTML = '<p>No publications found in file.</p>';
      }

    } catch (error) {
      console.error('Error:', error);
      container.innerHTML = `<p>Error: ${error.message}</p>`;
    }
  }

  document.addEventListener('DOMContentLoaded', fetchAndDisplayRandomPublication);
</script>

</body>
</html>
